/** 
 * 
 */
package utbm.ia54.ant2dgrid.skills

import utbm.ia54.ant2dgrid.capacities.PheromoneCapacity
import utbm.ia54.ant2dgrid.objects.Vector2i
import utbm.ia54.ant2dgrid.capacities.MotionCapacity
import java.util.UUID
import java.util.List
import utbm.ia54.ant2dgrid.Enum.Direction
import utbm.ia54.ant2dgrid.objects.Cell
import utbm.ia54.ant2dgrid.capacities.EnvironmentManagerCapacity
import utbm.ia54.ant2dgrid.objects.AntBody
import utbm.ia54.ant2dgrid.Enum.CellState

/** 
 * @author Michel
 * 
 */
skill MotionSkill implements MotionCapacity{
	
	def move(direction : Direction) {
		throw new UnsupportedOperationException("TODO: auto-generated method stub")
	}
	
	def randomMove {
		throw new UnsupportedOperationException("TODO: auto-generated method stub")
	}
	
}

skill PheromoneSkill implements PheromoneCapacity{
	
	def followPheromone(position : Vector2i) {
		throw new UnsupportedOperationException("TODO: auto-generated method stub")
	}
	
}

skill EnvironmentManagerSkill implements EnvironmentManagerCapacity{
	
	val width : int
	val height : int
	var grid : List<Cell>
	val antQuantity : int
	var homeCell : Cell
	var foodCell : Cell
	
	new(width : int, height : int, grid : List<Cell>, quantity : int) {
		this.width = width
		this.height = height
		this.grid = grid
		this.antQuantity = quantity
		defineCell	
	}
	
	private def defineCell {
		for (var i = 0; i < width; i++) {
			for (var j = 0; j < height; j++) {
				if (grid.get(i * height + j).state === CellState.HOME) {
					homeCell = grid.get(i * height + j)
				} else if (grid.get(i * height + j).state === CellState.FOOD) {
					foodCell = grid.get(i * height + j)
				}
			}
		}
	}
	
	def getWidth : int {
		this.width
	}
	
	def getHeight : int {
		this.height
	}
	
	def getGrid : List<Cell> {
		this.grid
	}
	
	def getAntQuantity : int{
		this.antQuantity
	}
	
	def createAnt (id : UUID, body : AntBody): AntBody {
		this.grid.get(homeCell.position.x * height + homeCell.position.y).addAnt(id, body)
	}
	
	def sendPerception(id : UUID, list : List<Cell>) {
		
	}
	
	def getHomeCell : Cell {
		defineCell
		this.homeCell
	}
	
	def getFoodCell : Cell {
		defineCell
		this.foodCell
	}
	
	def getCell(i : int) : Cell {
		this.grid.get(i)
	}
	
}